clear all;clc;
d(:,:,1)=[1 1 0 0 0 1 1; 
   1 1 0 1 0 1 1;
   1 1 0 1 0 1 1;
   1 1 0 1 0 1 1;
   1 0 0 0 0 0 1;
   1 0 1 1 1 0 1;
   1 0 1 1 1 0 1;
   1 0 1 1 1 0 1;
   0 0 1 1 1 0 0;];
d(:,:,2)=[1 0 0 0 0 0 1; 
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 0 0 0 0 1;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 0 0 0 0 1;];
d(:,:,3)=[1 0 0 0 0 0 0; 
    0 1 1 1 1 1 1;
    0 1 1 1 1 1 1;
    0 1 1 1 1 1 1;
    0 1 1 1 1 1 1;
    0 1 1 1 1 1 1;
    0 1 1 1 1 1 1;
    0 1 1 1 1 1 1;
    1 0 0 0 0 0 0;];
d(:,:,4)=[1 0 0 0 0 0 1; 
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 1 1 1 1 0;
   1 0 0 0 0 0 1;];
d(:,:,5)=[0 0 0 0 0 0 0; 
   0 1 1 1 1 1 1;
   0 1 1 1 1 1 1;
   0 1 1 1 1 1 1;
   0 0 0 0 0 0 1;
   0 1 1 1 1 1 1;
   0 1 1 1 1 1 1;
   0 1 1 1 1 1 1;
   0 0 0 0 0 0 0;];

d(d==0)=-1;
for i=1:size(d,3)
    A(i,:)=reshape(d(:,:,i),1,63);
end

N=size(A,2); T=zeros(N);
for i=1:size(d,3)
T=T+A(i,:)'*A(i,:);
end

for i=1:size(d,3)
    rec(i,:)=A(i,:)*T;
    I(:,:,i)=sign(reshape(rec(i,:),9,7));
end
figure
for i=1:size(d,3)
    subplot(2,size(d,3),i)
    imagesc(d(:,:,i))
    axis off
    title('Actual')
    subplot(2,size(d,3),i+size(d,3))
    imagesc(I(:,:,i))
    axis off
    title('Predicted')
end